var fledge=function(e){"use strict";const r={seller:"string",decisionLogicUrl:"url",interestGroupBuyers:"mixed",trustedScoringSignalsUrl:"url",additionalBids:"array",auctionSignals:"object",sellerSignals:"object",perBuyerSignals:"object"},t={owner:"string",name:"string",biddingLogicUrl:"url",dailyUpdateUrl:"url",trustedBiddingSignalsUrl:"url",trustedBiddingSignalsKeys:"array",userBiddingSignals:"object",ads:"array"},o=(e,r,t)=>r.map((r=>`'${r}' requires a type of "${t[r]}"! A type of ${typeof e[r]} was provided instead.`)),n={array:e=>"undefined"!==e&&Array.isArray(e),number:e=>"undefined"!==e&&"number"==typeof e,object:e=>"undefined"!==e&&"object"==typeof e&&null!==e&&!Array.isArray(e),string:e=>"undefined"!==e&&"string"==typeof e,mixed:e=>"undefined"!==e&&(Array.isArray(e)||"string"==typeof e),url:e=>{try{return Boolean(new URL(e))}catch(e){return!1}}},s=(e,r)=>new Promise(((t,o)=>{const n=o=>{r(o)&&(e.removeEventListener("message",n),e.removeEventListener("messageerror",s),t(o))},s=t=>{r(t)&&(e.removeEventListener("message",n),e.removeEventListener("messageerror",s),o(new Error("Message deserialization error")))};e.addEventListener("message",n),e.addEventListener("messageerror",s)}));const i=({source:e,target:r=document.body,props:t={},style:o={}})=>{if(!e)throw new Error("Something went wrong! No URL was found.");const n=new URL(e,document.baseURI),s=document.createElement("iframe"),i={src:n,...t},a={"border-width":0,...o};return Object.entries(i).map((([e,r])=>s.setAttribute(e,r))),Object.entries(a).map((([e,r])=>s.style.setProperty(e,r))),r.appendChild(s),{iframe:s,origin:n.origin}},a={getFramePort:async function(e,r){const{data:t,ports:o,origin:n}=await s(window,(({source:r})=>r===e.contentWindow));if(n!==r)throw new Error(`Message origins are mismatched! Expected ${r}, received ${n}`);if(1!==t["fledge.polyfill"])throw new Error(`Message versions are mismatched! Expected 1, but received ${t["fledge.polyfill"]}`);if(1!==o.length)throw new Error(`Message ports are mismatched! Expected 1 port, received ${o.length}`);return o[0]},getFromFrame:function(e){const r=s(e,(()=>!0));return e.start(),r},get:s},l=(e,r)=>{const t=Object.entries(e).filter((([e,t])=>!n[r[e]](t))).flatMap((([e])=>e));if(t.length)throw new Error(o(e,t,r).join(". "));return!1},d=(e,r)=>{const t=r.filter((r=>!e.hasOwnProperty(r)));if(t.length)throw new Error(`Required options are missing! You must provide an 'object' of options with all of the following required options: ${t.join(", ")}.`);return!1},u=(e,r)=>{if(!n[r](e))throw new Error(`Must be of type "${r}"! ${typeof e} was provided.`)},p=2592e6;return e.Fledge=class{constructor(e){this.url=e||"http://localhost:8000/iframe.html";const{iframe:r,origin:t}=i({source:this.url,style:{display:"none"}});r.sandbox.add("allow-same-origin","allow-scripts");const o=a.getFramePort(r,t);this._props={url:e,port:o}}get props(){return this._props}async joinAdInterestGroup(e,r){if(u(e,"object"),u(r,"number"),d(e,["owner","name","biddingLogicUrl"]),l(e,t),r>p)throw new Error("'expiry' is set past the allowed maximum value. You must provide an expiration that is less than or equal to 2592000000.");(await this.props.port).postMessage(["joinAdInterestGroup",[e,r]])}async leaveAdInterestGroup(e){u(e,"object"),d(e,["owner","name"]),l(e,t);(await this.props.port).postMessage(["leaveAdInterestGroup",[e]])}async runAdAuction(e){u(e,"object"),d(e,["seller","decisionLogicUrl","interestGroupBuyers"]),l(e,r);const{url:t}=this.props,o=await this.props.port,{port1:n,port2:s}=new MessageChannel;try{o.postMessage(["runAdAuction",[e]],[s]);const{data:r}=await a.getFromFrame(n);if(!r[0])throw new Error("No response from the iframe was found!");const[,i]=r;return null===i?null:`${t}#${i}`}finally{n.close()}}},e}({});
